{"version":3,"sources":["../../src/schema/context.ts"],"names":["withResolverContext","schema","schemaComposer","context","customContext","nodeModel","stats","tracer","nodeStore","require","LocalNodeModel","createPageDependency","defaultFieldResolver","withContext","path","undefined","module","exports"],"mappings":";;;;;AAGA;;AAEA;;AACA;;AAIe,SAASA,mBAAT,CAA6C;AAC1DC,EAAAA,MAD0D;AAE1DC,EAAAA,cAF0D;AAG1DC,EAAAA,OAH0D;AAI1DC,EAAAA,aAJ0D;AAK1DC,EAAAA,SAL0D;AAM1DC,EAAAA,KAN0D;AAO1DC,EAAAA;AAP0D,CAA7C,EAgB4B;AACzC,QAAMC,SAAS,GAAGC,OAAO,CAAE,aAAF,CAAzB;;AAEA,MAAI,CAACJ,SAAL,EAAgB;AACdA,IAAAA,SAAS,GAAG,IAAIK,yBAAJ,CAAmB;AAC7BF,MAAAA,SAD6B;AAE7BP,MAAAA,MAF6B;AAG7BC,MAAAA,cAH6B;AAI7BS,MAAAA,oBAAoB,EAApBA;AAJ6B,KAAnB,CAAZ;AAMD;;AAED,SAAO,EACL,IAAIR,OAAO,IAAI,EAAf,CADK;AAEL,QAAIC,aAAa,IAAI,EAArB,CAFK;AAGLQ,IAAAA,oBAAoB,EAApBA,+BAHK;AAILP,IAAAA,SAAS,EAAEA,SAAS,CAACQ,WAAV,CAAsB;AAC/BC,MAAAA,IAAI,EAAEX,OAAO,GAAGA,OAAO,CAACW,IAAX,GAAkBC;AADA,KAAtB,CAJN;AAOLT,IAAAA,KAAK,EAAEA,KAAK,IAAI,IAPX;AAQLC,IAAAA,MAAM,EAAEA,MAAM,IAAI;AARb,GAAP;AAUD;;AAEDS,MAAM,CAACC,OAAP,GAAiBjB,mBAAjB","sourcesContent":["import { GraphQLSchema } from \"graphql\"\nimport { SchemaComposer } from \"graphql-compose\"\n\nimport { createPageDependency } from \"../redux/actions/add-page-dependency\"\n\nimport { LocalNodeModel } from \"./node-model\"\nimport { defaultFieldResolver } from \"./resolvers\"\nimport { IGraphQLRunnerStats } from \"../query/types\"\nimport { IGatsbyResolverContext, IGraphQLSpanTracer } from \"./type-definitions\"\n\nexport default function withResolverContext<TSource, TArgs>({\n  schema,\n  schemaComposer,\n  context,\n  customContext,\n  nodeModel,\n  stats,\n  tracer,\n}: {\n  schema: GraphQLSchema\n  schemaComposer: SchemaComposer<IGatsbyResolverContext<TSource, TArgs>> | null\n  context?: Record<string, any>\n  customContext?: Record<string, any>\n  nodeModel?: any\n  stats?: IGraphQLRunnerStats | null\n  tracer?: IGraphQLSpanTracer\n}): IGatsbyResolverContext<TSource, TArgs> {\n  const nodeStore = require(`../db/nodes`)\n\n  if (!nodeModel) {\n    nodeModel = new LocalNodeModel({\n      nodeStore,\n      schema,\n      schemaComposer,\n      createPageDependency,\n    })\n  }\n\n  return {\n    ...(context || {}),\n    ...(customContext || {}),\n    defaultFieldResolver,\n    nodeModel: nodeModel.withContext({\n      path: context ? context.path : undefined,\n    }),\n    stats: stats || null,\n    tracer: tracer || null,\n  }\n}\n\nmodule.exports = withResolverContext\n"],"file":"context.js"}